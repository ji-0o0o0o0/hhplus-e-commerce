# ğŸ“¦ E-ì»¤ë¨¸ìŠ¤ ì„œë¹„ìŠ¤ ì”¨í€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

---


## 1ï¸âƒ£ ì”ì•¡ ì¶©ì „ / ì¡°íšŒ ê¸°ëŠ¥

### ğŸ”¹ í¬ì¸íŠ¸ ì¶©ì „ 
```mermaid
sequenceDiagram
    User->>+Point: [POST] /api/v1/points/{userId}<br>ì”ì•¡ ì¶©ì „ ìš”ì²­
    activate Point
    Point->>Point: ì”ì•¡ ì¶©ì „
    deactivate Point
    Point->>+PointHistory: ì”ì•¡ ì¶©ì „ ì´ë ¥ ì €ì¥
    Point-->>-User: ì”ì•¡ ì¶©ì „ ê²°ê³¼ ë°˜í™˜

```
---

### ğŸ”¹ í¬ì¸íŠ¸ ì¡°íšŒ 
```mermaid
sequenceDiagram
    User->>+Point: [GET] /api/v1/points/{userId}<br>ì”ì•¡ ì¡°íšŒ ìš”ì²­
    activate Point
    Point->>Point: ì”ì•¡ ì¡°íšŒ
    deactivate Point
    Point-->>-User: ì”ì•¡ ì¡°íšŒ ê²°ê³¼ ë°˜í™˜


```
---

## 2ï¸âƒ£ ìƒí’ˆ ì¡°íšŒ ê¸°ëŠ¥

### ğŸ”¹ ìƒí’ˆ ëª©ë¡ ì¡°íšŒ 
```mermaid
sequenceDiagram
    User->>+Product: [GET] /api/v1/products<br>ìƒí’ˆ ì¡°íšŒ ìš”ì²­
    Product-->>-User: ìƒí’ˆ ì¡°íšŒ ê²°ê³¼ ë°˜í™˜

```
---

## 3ï¸âƒ£ ì„ ì°©ìˆœ ì¿ í° ë°œê¸‰ / ì¡°íšŒ ê¸°ëŠ¥

### ğŸ”¹ ì¿ í° ë°œê¸‰
```mermaid
sequenceDiagram
    User->>+CouponController: [POST] /api/v1/coupons/{couponId}/issue<br>ì„ ì°©ìˆœ ì¿ í° ë°œê¸‰ ìš”ì²­
    CouponController->>+CouponService: ì¿ í° ë°œê¸‰
    CouponService->>+CouponRepository: ì”ì—¬ ì¿ í° ìˆ˜ëŸ‰ ì¡°íšŒ
    CouponRepository-->>-CouponService: ì”ì—¬ ì¿ í° ìˆ˜ëŸ‰ ë°˜í™˜
    alt ì”ì—¬ ìˆ˜ëŸ‰ == 0
        CouponService-->>User: ì¿ í° ë°œê¸‰ ì‹¤íŒ¨
    else ì”ì—¬ ìˆ˜ëŸ‰ > 0
        CouponService->>+UserCouponRepository: ì¿ í° ë°œê¸‰ ì´ë ¥ ì¡°íšŒ
        UserCouponRepository-->>-CouponService: ì¿ í° ë°œê¸‰ ì´ë ¥ ë°˜í™˜
        alt ë°œê¸‰ ì´ë ¥ ì¡´ì¬
            CouponService-->>User: ì¿ í° ë°œê¸‰ ì‹¤íŒ¨
        else ë°œê¸‰ ì´ë ¥ ì—†ìŒ
            CouponService->>CouponRepository: ì”ì—¬ ì¿ í° ìˆ˜ëŸ‰ ì°¨ê°
            CouponService->>UserCouponRepository: ì¿ í° ë°œê¸‰ ì´ë ¥ ì €ì¥
            CouponService-->>-CouponController: ë°œê¸‰ëœ ì¿ í° ì •ë³´ ë°˜í™˜
            CouponController-->>-User: ì¿ í° ë°œê¸‰ ê²°ê³¼ ë°˜í™˜
        end
    end


```
---

### ğŸ”¹ ë³´ìœ  ì¿ í° ì¡°íšŒ 
```mermaid
sequenceDiagram
    User->>+Coupon: [GET] /api/v1/coupons?userId={userId}<br>ë³´ìœ  ì¿ í° ëª©ë¡ ì¡°íšŒ ìš”ì²­
    activate Coupon
    Coupon->>Coupon: ì¿ í° ëª©ë¡ ì¡°íšŒ
    deactivate Coupon
    Coupon-->>-User: ë³´ìœ  ì¿ í° ëª©ë¡ ì¡°íšŒ ê²°ê³¼ ë°˜í™˜

```
---

## 4ï¸âƒ£ ì£¼ë¬¸ / ê²°ì œ ê¸°ëŠ¥

### ğŸ”¹ ì£¼ë¬¸ ìƒì„± 
```mermaid
sequenceDiagram
     User->>+Order: [POST] /api/v1/orders<br>ì£¼ë¬¸ ìƒì„± ìš”ì²­
     Order->>+Product: ì¬ê³  ì¡°íšŒ
     Product-->>-Order: ì¬ê³  ë°˜í™˜
     alt ì¬ê³  ë¶€ì¡±
         Order-->>User: ì£¼ë¬¸ ì‹¤íŒ¨
     else ì¬ê³  ì¶©ë¶„
         Order->>+Product: ì¬ê³  ì°¨ê°ìš”ì²­
        activate Product
        Product->>Product: ì¬ê³  ì°¨ê°
        deactivate Product
         Order->>+Coupon: ì¿ í° ì ìš© ìš”ì²­
         activate Coupon
         Coupon->>Coupon: ì¿ í° ìœ íš¨ì„± ê²€ì¦ ë° ì¿ í° ì ìš©
         deactivate Coupon
         Coupon-->>-Order: ì¿ í° ì ìš© ê¸ˆì•¡ ë°˜í™˜
         activate Order
         Order->>Order: ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸(NOT_PAID)
         deactivate Order
         activate Order
         Order->>Order: ì£¼ë¬¸ ì €ì¥
         deactivate Order
         Order-->>-User: ì£¼ë¬¸ ìƒì„± ê²°ê³¼ ë°˜í™˜
     end


```
---
### ğŸ”¹ ì£¼ë¬¸ í™•ì¸ ìŠ¤ì¼€ì¤„ëŸ¬
```mermaid
sequenceDiagram
    FailOrderScheduler->>+Order: ê²°ì œê°€ ì•ˆëœ ì±„ë¡œ 5ë¶„ì´ ì§€ë‚œ ì£¼ë¬¸ ì¡°íšŒ ìš”ì²­
    activate Order
    Order->>Order: ê²°ì œê°€ ì•ˆëœ ì±„ë¡œ 5ë¶„ì´ ì§€ë‚œ ì£¼ë¬¸ ì¡°íšŒ
    deactivate Order
    Order-->>-FailOrderScheduler: ê²°ì œê°€ ì•ˆëœ ì±„ë¡œ 5ë¶„ì´ ì§€ë‚œ ì£¼ë¬¸ ë°˜í™˜
    FailOrderScheduler->>+Order: ì£¼ë¬¸ ìƒíƒœ EXPIRED ì²˜ë¦¬ ìš”ì²­
    activate Order
    Order->>Order: ì£¼ë¬¸ ìƒíƒœ EXPIRED ì²˜ë¦¬
    deactivate Order
    FailOrderScheduler->>+Product: ì¬ê³  ë¡¤ë°± ìš”ì²­
    activate Product
    Product->>Product: ì¬ê³  ë¡¤ë°± ì²˜ë¦¬
    deactivate Product
    FailOrderScheduler->>+Coupon: ì¿ í° ì‚¬ìš© ì—¬ë¶€ ì¡°íšŒ ìš”ì²­
    Coupon-->>-FailOrderScheduler: ì¿ í° ì‚¬ìš© ì—¬ë¶€ ë°˜í™˜
    alt ì¿ í°ì´ ì‚¬ìš©ë¨
        FailOrderScheduler->>+Coupon: ì¿ í° ì‚¬ìš© false ì²˜ë¦¬ ìš”ì²­
        activate Coupon
        Coupon->>Coupon: ì¿ í° ì‚¬ìš© ì—¬ë¶€ false
        deactivate Coupon
    end

```
---

### ğŸ”¹ ê²°ì œ 
```mermaid
sequenceDiagram
    User->>+Point: [POST] /api/v1/payments<br>ê²°ì œ ìš”ì²­
    activate Point
    Point->>Point: ì”ì•¡ ì¡°íšŒ
    deactivate Point
    alt ì”ì•¡ ë¶€ì¡±
        Point-->>User: ê²°ì œ ì‹¤íŒ¨
    else ì”ì•¡ ì¶©ë¶„
        activate Point
        Point->>Point: í¬ì¸íŠ¸ ì°¨ê°
        deactivate Point
        activate Point
        Point->>Point: í¬ì¸íŠ¸ ì°¨ê° ì´ë ¥ ì €ì¥
        deactivate Point
        Point->>Order: ì£¼ë¬¸ ìƒíƒœ ë³€ê²½
        activate Order
        Order->>Order: ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸(PAID)
        deactivate Order
        Point->>Data Platform: ì£¼ë¬¸ ì •ë³´ ì „ì†¡
        Point-->>-User: ê²°ì œ ì„±ê³µ ê²°ê³¼ ë°˜í™˜
    end

```
---

## 5ï¸âƒ£ ìƒìœ„ ìƒí’ˆ ì¡°íšŒ ê¸°ëŠ¥
---
### ğŸ”¹ í†µê³„ ì¸ì… ìŠ¤ì¼€ì¤„ëŸ¬
```mermaid
sequenceDiagram
    BestSellerScheduler->>+Order: ìµœê·¼ 3ì¼ê°„ ì£¼ë¬¸ ì™„ë£Œëœ ìƒí’ˆ ì¡°íšŒ ìš”ì²­
    activate Order
    Order->>Order: ìµœê·¼ 3ì¼ê°„ ì£¼ë¬¸ ì™„ë£Œëœ ìƒí’ˆ ì¡°íšŒ
    deactivate Order
    Order->>-BestSellerScheduler: ìµœê·¼ 3ì¼ê°„ ì£¼ë¬¸ ì™„ë£Œëœ ìƒí’ˆ ë°˜í™˜
    activate BestSellerScheduler
    BestSellerScheduler->>BestSellerScheduler: íŒë§¤ëŸ‰ ìƒìœ„ 5ê°œ ìƒí’ˆ ì¶”ì¶œ
    deactivate BestSellerScheduler
    BestSellerScheduler->>BestSeller: ì¶”ì¶œí•œ ìƒìœ„ 5ê°œ ìƒí’ˆ ì €ì¥

```
---

### ğŸ”¹ ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì¡°íšŒ

```mermaid
sequenceDiagram
    User->>+BestSeller: [GET] /api/v1/products/best<br>íŒë§¤ëŸ‰ ìƒìœ„ 5ê°œ ìƒí’ˆ ì¡°íšŒ ìš”ì²­
    BestSeller-->>-User: íŒë§¤ëŸ‰ ìƒìœ„ 5ê°œ ìƒí’ˆ ë°˜í™˜

```

